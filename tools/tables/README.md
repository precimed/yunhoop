## Contents

* [mixer_uni_table.sh](#mixer_uni_tablesh)
* [mixer_bi_table.sh](#mixer_bi_tablesh)
* [fdr_fuma_snp_input.sh](#fdr_fuma_snp_inputsh)
* [fdr_fuma_snp_table.sh](#fdr_fuma_snp_tablesh)
* [fdr_fuma_loci_table.sh](#fdr_fuma_loci_tablesh)
* [fdr_fuma_loci_overlap.sh](#fdr_fuma_loci_overlapsh)
* [fdr_fuma_gene_table.sh](#fuma_gene_tablesh)
* [fdr_fuma_go_table.sh](#fuma_go_tablesh)
* [fdr_cpdb_pathway_table.sh](#fdr_cpdb_pathway_tablesh)
* [fdr_fuma_trans_loci_table.sh](#fdr_fuma_trans_loci_tablesh)

## Summary of scripts

### mixer_uni_table.sh

**Function**
This script tries to extract data from mixer analysis for supplementary univariate table.

**Usage** ``sh mixer_uni_table.sh uni_csv outfile``

**Arguments**
* `uni_csv` - csv file containing univariate info
* `outfile` - output file

### mixer_bi_table.sh

**Function**
This script tries to extract data from mixer analysis for supplementary bivariate table.

**Usage** ``sh mixer_bi_table.sh bi_csv outfile``

**Arguments**
* `bi_csv` - csv file containing bivariate info
* `outfile` - output file

### fdr_fuma_snp_input.sh

**Function**
This script tries to generate a snp list from pleioFDR output for FUMA analysis.

**Usage** ``sh fdr_fuma_snp_input.sh fdr_clump_snp_file fdr R2 outfile [exclude_region_list]``

**Arguments**
* `fdr_clump_snp_file` - fdr clumping snp file
* `fdr` - FDR filter for selecting snps
* `R2` - pleioFDR R2 filter for selecting snps
* `outfile` - output file including selected snp list
* `exclude_region_list` - regions with 'complex LD structure' to be excluded delimited by ':', eg:
                   MHC - 6 25119106 33854733; all traits. Given the size of the MHC it is probably sensible to exclude for all analyses
                   8p23 inversion - 8 7200000 12500000; psychiatric disorders and related traits
                   MAPT region - 17 43384864 44913631; neurological disorders e.g. Parkinson.s disease.
                   APOE region - 19 42000000 47000000; Alzheimer.s disease and autism spectrum disorder

**Example**
```
sh fdr_fuma_snp_input.sh conj.result.clump.snps.csv 0.1 0.6 TRAIT1_vs_TRAIT2_input_snps.txt '6 25119106 33854733:8 7200000 12500000'
```

### fdr_fuma_snp_table.sh

**Function**
This script tries to generate data for supplementary snp table (FUMA+SUMSTAT) based on selected snp subset (fdr,r2) from pleioFDR/FUMA analysis.
NOTE: there might be difference between the loci numbers from pleioFDR analysis and the ones from FUMA analysis (GenomicLocus). This is because the former
is based on clumping of pleioFDR, while the latter is based on clumping of p-value, good to distiguish between them.

**Usage** ``sh fdr_fuma_snp_table.sh fdr_clump_snp_file fdr r2 fuma_snp_file sumstat1 sumstat2 tag1 tag2 outfolder``

**Arguments**
* `fdr_clump_snp_file` - fdr clumping snp file
* `fdr` - pleioFDR filter for selecting snps
* `r2` - r2 filter for selecting snps
* `fuma_snp_file` - fuma annotated snp file
* `sumstat1` - primary summary statistic file
* `sumstat2` - secondary summary statistic file
* `tag1` - tag of trait1
* `tag2` - tag of trait2
* `outfolder` - output folder

**Example**
```
sh fdr_fuma_snp_table.sh conj.result.clump.snps.csv 0.1 0.6 snps.txt sumstat/std/trait1.sumstats.gz sumstat/std/trait2.sumstats.gz tag1 tag2 outfolder
```

### fdr_fuma_loci_table.sh

**Function**
This script tries to generate data for supplementary loci table (pleioFDR+FUMA+SUMSTAT) from pleioFDR/FUMA analysis.

**Usage** ``sh fdr_fuma_loci_table.sh fdr_clump_loci_file fdr_fuma_snp_table outfile [trait1locifile trait2locifile] [fuma_gwasc keywords1 keywords2]``

**Arguments**
* `fdr_clump_loci_file` - fdr clumping loci file
* `fdr_fuma_snp_table` - TRAIT1_vs_TRAIT2_snps.txt file generated by script fdr_fuma_snp_table.sh
* `outfile` - output file, recommanded to name as TRAIT1_vs_TRAIT2_loci.txt
* `trait1locifile` - old loci file with 3 or 4 columns (CHR, MinBP, MaxBP, [leadSNP]) of trait1, use '-' for none
* `trait2locifile` - old loci file with 3 or 4 columns (CHR, MinBP, MaxBP, [leadSNP]) of trait2, use '-' for none
* `fuma_gwasc` - fuma gwascatalog file, use '-' for none
* `keywords1` - quoted keywords of trait1 combined with &, delimited by |, use '-' for none
* `keywords2` - quoted keywords of trait2 combined with &, delimited by |, use '-' for none

**Example**
```
sh fdr_fuma_loci_table.sh conj.result.clump.loci.csv ADHD_vs_MOOD_snps.txt ADHD_vs_MOOD_loci.txt adhd_gwas_loci.csv mood_gwas_loci.csv gwascatalog.txt 'attention & deficit & hyperact' 'mood & instab'
```

### fdr_fuma_loci_overlap.sh
**Function**
This script tries to figure out overlapping loci of other traits for each specific trait across a group of FDR/FUMA analyses to add an additional 'Overlapping_loci' column to tables generated by script fdr_fuma_loci_table.sh

**Usage** ``sh fdr_fuma_loci_overlap.sh fdr_fuma_loci_list outfile``

**Arguments**
* `fdr_fuma_loci_list` - file that includes paths to TRAIT1_vs_TRAIT2_loci.txt files generated by script fdr_fuma_loci_table.sh
* `outfile` - output file of overlapping loci

**Example**
```
sh fdr_fuma_loci_overlap.sh mood_psych_loci_conj005.txt mood_psych_conj005_shared_loci.txt

mood_psych_loci_conj005.txt: https://github.com/precimed/yunhoop/blob/master/config/mood_psych_conj005_clump_loci.txt
```

### fdr_fuma_gene_table.sh

**Function**
This script tries to generate data for supplementary gene table from pleioFDR/FUMA analysis.

**Usage** ``sh fdr_fuma_gene_table.sh fdr_fuma_snp_table fuma_gene_file outfile``

**Arguments**
* `fdr_fuma_snp_table` - TRAIT1_vs_TRAIT2_snps.txt file generated by script fdr_fuma_snp_table.sh
* `fuma_gene_file` - file that contains fuma gene info
* `outfile` - output file

**Example**
```
sh fdr_fuma_gene_table.sh TRAIT1_vs_TRAIT2_snps.txt genes.txt TRAIT1_vs_TRAIT2_genes.txt
```

### fdr_fuma_go_table.sh

**Function**
This script tries to generate data for supplementary gene ontology gene-set table from pleioFDR/FUMA analysis analysis.

**Usage** ``sh fdr_fuma_go_table.sh fdr_fuma_gene_table fuma_gs_file outfile``

**Arguments**
* `fdr_fuma_gene_table` - TRAIT1_vs_TRAIT2_genes.txt file generated by script fdr_fuma_gene_table.sh
* `fuma_gs_file` - file that contains fuma gene-set info
* `outfile` - output file

**Example**
```
sh fdr_fuma_go_table.sh MD_vs_CRP_genes.txt GS.txt TRAIT1_vs_TRAIT2_go.txt
```

### fdr_fuma_pathway_table.sh

**Function**
This script tries to generate data for supplementary gene ontology gene-set table from pleioFDR/FUMA/ConsensusPDB analysis.

**Usage** ``sh fdr_cpdb_pathway_table.sh fdr_fuma_gene_table cpdb_ora_file outfile``

**Arguments**
* `fdr_fuma_gene_table` - TRAIT1_vs_TRAIT2_genes.txt file generated by script fdr_fuma_gene_table.sh
* `cpdb_ora_file` - file that contains cpdb gene-set info
* `outfile` - output file

**Example**
```
sh fdr_cpdb_pathway_table.sh MD_vs_CRP_genes.txt ORA_MD_CRP.txt MD_vs_CRP_path.txt
```

### fdr_fuma_trans_loci_table.sh

**Function**
This script tries to identify transdiagnostic loci shared across multiple traits from pleioFDR/FUMA analysis.

**Usage** ``sh fdr_fuma_trans_loci.sh list_of_loci_files outfile``

**Arguments**
* `list_of_loci_files` - file that includes paths to shared loci file, and fdr_fuma_snp_table, make sure that absolute or relative path to be specified
* `outfile` - output file that contains transdiagnostic loci fdr/fuma results

**Example**
```
sh fdr_fuma_trans_loci.sh mood_psych_shared_loci_conj005.txt mood_psych_conj005_trans_loci.txt

mood_psych_shared_loci_conj005.txt: https://github.com/precimed/yunhoop/blob/master/config/mood_psych_shared_loci_conj005.txt
the $shared_loci_file can be grenerated through novelty/identify_overlap_loci.sh
```
